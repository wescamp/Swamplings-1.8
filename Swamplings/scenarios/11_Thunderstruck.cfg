#textdomain wesnoth-s
[scenario]
    id=11_Thunderstruck
    name= _ "Thunderstruck"
    map_data="{~add-ons/Swamplings/maps/PogoBog07}"
    {SCENARIO_MUSIC "a3deap_GoForTheWorldAgain.ogg"}
    turns=30
	victory_when_enemies_defeated=no

    {DAWN}
    {MORNING}
    {AFTERNOON}
    {DUSK}
    {FIRST_WATCH}
    {SECOND_WATCH}

    next_scenario=12_Meet_Mister_Blydd

# prevents the recall of Kennison
[disallow_recruit]
	type=Bowman
	type=Longbowman
	type=Master Bowman
[/disallow_recruit]

    [side]
        side=1
        team_name=1
        user_team_name=_"Eeep's Squad"
        controller=human
        id=Eeep
        name= _ "Eeep"
        type=Goblin Impaler
		x,y=20,21
	    [modifications]
            {TRAIT_SWAMPSAVVY}
            {TRAIT_DIM}
			{TRAIT_LOYAL}
        [/modifications]
        unrenamable=yes
        canrecruit=yes
		recruit=Goblin Spearman, Wolf Rider
        {GOLD 250 200 175}
    [/side]
    [side]
        side=2
        team_name=2
        user_team_name=_"Saurian Refugees"
		id=Zslap
		name= _ "Zslap"
		type=Saurian Ambusher
		unrenamable=yes
        canrecruit=yes
        recruit=Saurian Skirmisher, Saurian Augur
        x,y=12,21
		# they consider side 5 half as valuable as other sides
		[ai]
			[target]
				side=5
				value=0.5
			[/target]
		[/ai]
		{GOLD 200 300 400}
    [/side]
    [side]
        side=3
        team_name=1
        user_team_name=_"Dwarven Delivery Service"
        controller=human
        id=Duldursil
        name= _ "Duldursil"
        type=Dwarvish Thunderer
        unrenamable=yes
        canrecruit=no
		x,y=13,9
		animate=yes
        {GOLD 0 0 0}
        persistent=0
    [/side]
    [side]
        side=4
        team_name=1
        user_team_name=_"Misris' Squad"
        controller=human
        id=Misris
        name= _ "Misris"
        type=Wolf Rider
        unrenamable=yes
		gender=female
	    unrenamable=yes
		[modifications]
			{TRAIT_LOYAL}
	        {TRAIT_SWAMPSAVVY}
	    [/modifications]
	    profile="unit_image"
        x,y=3,7
        canrecruit=yes
		recruit=Vampire Bat, Goblin Spearman
        {GOLD 250 200 175}
        persistent=0
    [/side]
    [side]
		no_leader=yes
        side=5
        team_name=5
        user_team_name=_"Wild Things"
        {GOLD 0 0 0}
		# this side will avoid saurian keep for the first 2 turns
		[ai]
			turns=1-2
			[avoid]
				x=3-5
				y=20-22
			[/avoid]
		[/ai]
		# this side will avoid Misris' keep for the first 2 turns
		[ai]
			turns=1-2
			[avoid]
				x=22-24
				y=4-6
			[/avoid]
		[/ai]
		# this side will avoid Eeep's keep for the first 2 turns
		[ai]
			turns=1-2
			[avoid]
				x=19-21
				y=20-22
			[/avoid]
		[/ai]
		# they consider side 2 half as valuable
		[ai]
			[target]
				side=2
				value=0.5
			[/target]
		[/ai]
    [/side]

[event]
	name=start

	{SS_TRAIT_ON_ADVANCEMENT}

	# Thundergobos have a chance of shooting themselves if they miss. Defined in traits.cfg:
	{LOOSE_CANNON}

	[item]
		x,y=7,23
		halo=data/add-ons/Swamplings/images/scenery/mangrove1.png
	[/item]
	[item]
		x,y=7,24
		halo=data/add-ons/Swamplings/images/scenery/mangrove2.png
	[/item]
	[item]
		x,y=8,22
		halo=data/add-ons/Swamplings/images/scenery/mangrove3.png
	[/item]
	[item]
		x,y=8,23
		halo=data/add-ons/Swamplings/images/scenery/mangrove4.png
	[/item]
	[item]
		x,y=8,24
		halo=data/add-ons/Swamplings/images/scenery/mangrove5.png
	[/item]
	[item]
		x,y=9,23
		halo=data/add-ons/Swamplings/images/scenery/mangrove6.png
	[/item]

[item]
	x,y=13,8
	image=data/campaigns/Sceptre_of_Fire/images/units/dwarves/caravan.png
[/item]

{UNIT 3 (Dwarvish Thunderguard) 14 8 (
	id=Augalol
    name= _ "Augalol"
    unrenamable=yes
    profile=portraits/dwarves/transparent/scout.png
    facing=sw
    animate=yes
)}

	[message]
		speaker=Duldursil
		message= _ "Aaaaaaaaaaaaaaaachhh!"
	[/message]

	{MODIFY_UNIT (id=Augalol) facing sw}

	[message]
		speaker=Augalol
		message= _ "Aaaaaaaaaaaaarrk!"
	[/message]
	[message]
		speaker=Duldursil
		message= _ "Augalol, where is the road? Where the blough is the briny, blough-bottled ROAD?"
	[/message]
	[message]
		speaker=Augalol
		message= _ "I DINNAE KNOW!"
	[/message]
	[message]
		speaker=Duldursil
		message= _ "Gae me the map! Here now! Here! We're exactly twelve point six degrees north of the twenty-sixth parallel, precisely, indisputably HERE!"
	[/message]
	[message]
		speaker=Augalol
		message= _ "Then where is the road?"
	[/message]
	[message]
		speaker=Duldursil
		message= _ "Aaaaaaaaaaaaaaaachhh!"
	[/message]
	[message]
		speaker=Augalol
		message= _ "I tell you there was a road! It ran straight down past the old fortress and direct into Fursnatch! I came through this briny spot of land not two aeon past!"
	[/message]
	[message]
		speaker=Duldursil
		message= _ "TWO AEON PAST? You festerin' bag of dead larks! "
	[/message]
	[message]
		speaker=Augalol
		message= _ "Aaaaaaaaaaaaarrk! Seems like yesterday!"
	[/message]
	[message]
		speaker=Duldursil
		message= _ "It's a bog! That's why we can't find the road, it's brinin' buried under a bloghin' bog!"
	[/message]
	[message]
		speaker=Augalol
		message= _ "Briny blazes! We're trapped!"
	[/message]
	[message]
		speaker=Duldursil
		message= _ "Don't say it!"
	[/message]
	[message]
		speaker=Augalol
		message= _ "We're trapped in a bog with ten briny cases of bloghin' thundersticks! Ten cases of the finest knalgan craftsmanship you've seen in your slop-sucking life! Worth more gold than â€“ shh! Who's that, then?"
	[/message]

{TELEPORT_UNIT (id=Misris) 10 10}
{MOVE_UNIT (id=Misris) 11 10}
	{MODIFY_UNIT (id=Misris) facing ne}

    [scroll_to_unit]
    	id=Duldursil
    [/scroll_to_unit]

	[message]
		speaker=Misris
		message= _ "What's a thunderstick?"
	[/message]

	{MODIFY_UNIT (id=Duldursil) facing sw}

	[message]
		speaker=Duldursil
		message= _ "What's a thunderstick? Well, never ye mind and run along, missy! That's what a thunderstick is!"
	[/message]

	{MODIFY_UNIT (id=Augalol) facing sw}

	[message]
		speaker=Augalol
		message= _ "Duldursil? Either that creature is riding a wolf or she has two heads, and I dinnae know which is more terrible!"
	[/message]
	[message]
		speaker=Duldursil
		message= _ "She's riding a wolf, ye blockheaded boob!"
	[/message]
	[message]
		speaker=Augalol
		message= _ "Here's a thunderstick, creature, and here's what it can do!"
	[/message]

	{MODIFY_UNIT (id=Augalol) facing ne}

# Augalol fires the thunderstick in the air.
[animate_unit]
        flag=attack
        with_bars=no
		[filter]
				id=Augalol
        [/filter]
		[primary_attack]
           name=thunderstick
        [/primary_attack]
        hits=yes
[/animate_unit]

	{MODIFY_UNIT (id=Augalol) facing sw}

	{MODIFY_UNIT (id=Duldursil) facing ne}

    [scroll_to_unit]
    	id=Duldursil
    [/scroll_to_unit]

	[message]
		speaker=Duldursil
		message= _ "Careful with the merchandise there!"
	[/message]
	[message]
		speaker=Misris
		message= _ "You know, that would be a great weapon."
	[/message]

	{MODIFY_UNIT (id=Duldursil) facing sw}

	[message]
		speaker=Duldursil
		message= _ "Ye don't say, missy, ye don't say!"
	[/message]
	[message]
		speaker=Misris
		message= _ "It would! Against the wild bats, the merfolk, bounty hunters, wolves, saurians ..."
	[/message]
	[message]
		speaker=Augalol
		message= _ "Bounty hunters? Ye've got <i>bounty hunters</i> in this blochin' bog?"
	[/message]
	[message]
		speaker=Duldursil
		message= _ "And saurians? Aaaaaaaaaaaaaaaachhh! With their briny spears and their cursin'! We're ruined! Ruined!"
	[/message]
	[message]
		speaker=Augalol
		message= _ "I always said this contract would destroy us!"
	[/message]
	[message]
		speaker=Misris
		message= _ "Who are they for? Humans, I bet!"
	[/message]
	[message]
		speaker=Duldursil
		message= _ "Now missy! We're honor-bound not to tell they're for humans!"
	[/message]
	[message]
		speaker=Augalol
		message= _ "And what's a dwarf without his honor? Nothing!"
	[/message]
	[message]
		speaker=Misris
		message= _ "Okay, we'll dig you out if you give us some."
	[/message]
	[message]
		speaker=Duldursil
		message= _ "Give you some thundersticks? By the heinous hammers of Hanasil, missy! Don't you know what it means to have a contract?"
	[/message]
	[message]
		speaker=Misris
		message= _ "Does it mean you have to die?"
	[/message]
	[message]
		speaker=Augalol
		message= _ "Duldursil! I dinnae want to die with a back full o' blochin' saurian spears in the briny mess of a blochin' bog! If the swampling lassie can help us salvage nine cases, I say let her have one for herself and let the humanfolk choke on it!"
	[/message]

	{MODIFY_UNIT (id=Duldursil) facing ne}

	[message]
		speaker=Duldursil
		message= _ "Aaaaaaaaaaaaaaaachhh! I admit, that's the wisest thing you've said in years, Augalol, though that's not saying much."
	[/message]
	[message]
		speaker=Augalol
		message= _ "That's our offer, lassie. If you can dig our wagon out and get us to solid ground, one case of thundersticks is yours. --What in the name of Rackham's Runes?"
	[/message]

	{MODIFY_UNIT (id=Augalol) facing nw}

# Bugbag jumps out of the back of the wagon

	{FAKE_UNIT_MOVE 13 12 8 6 1 (Goblin Spearman) ()}
	{UNIT 1 (Thundergobo) 12 6 (
	id=Bugbag
    name= _ "Bugbag"
    unrenamable=yes
    facing=se
    animate=no
	[modifications]
        {TRAIT_DIM}
        {TRAIT_SWAMPSAVVY}
    [/modifications]
)}
	{MODIFY_UNIT (id=Duldursil) facing nw}

	[message]
		speaker=Duldursil
		message= _ "PUT THAT DOWN, YOU BATTY GOBO!"
	[/message]

# Bugbag fires the thunderstick.
[animate_unit]
        flag=attack
        with_bars=no
		[filter]
			id=Bugbag
        [/filter]
		[primary_attack]
           name=thunderstick
        [/primary_attack]
        hits=yes
[/animate_unit]

#ifdef EASY
{UNIT 1 (Wolf Rider) 19 19 ()}
{LOYAL_UNIT 1 (Wolf Rider) 20 19}
{LOYAL_UNIT 1 (Vampire Bat) 20 23}
{LOYAL_UNIT 1 (Vampire Bat) 19 24}
#endif

        [scroll_to_unit]
        	id=Eeep
        [/scroll_to_unit]

	{UNIT 2 (Saurian Skirmisher) 12 20 (
	id=Krex
    name= _ "Krex"
    unrenamable=yes
    animate=no
    # placeholder, until some good saurian portraits are found
    profile=units/saurians/skirmisher.png
)}

	{UNIT 1 (Wolf Rider) 23 21 (
	id=Bigbash
    name= _ "Bigbash"
    unrenamable=yes
    facing=se
    animate=no
)}

	{UNIT 1 (Wolf Rider) 24 21 (
	id=Pronk
    name= _ "Pronk"
    unrenamable=yes
    facing=nw
    animate=no
)}

# Eeep is training the wolf riders. Two wolf riders attach each other.
[animate_unit]
        flag=attack
        with_bars=no
		[filter]
				id=Pronk
        [/filter]
		[primary_attack]
           name=fangs
        [/primary_attack]
        hits=yes
        [animate]
        	flag=defend
        [filter_second]
        	id=Bigbash
        [/filter_second]
        with_bars=no
        [facing]
			[filter]
				id=Pronk
    		[/filter]
       	[/facing]
        hits=yes
        [/animate]
[/animate_unit]

[animate_unit]
        flag=attack
        with_bars=no
		[filter]
				id=Bigbash
        [/filter]
		[primary_attack]
           name=fangs
        [/primary_attack]
        hits=yes
        [animate]
        	flag=defend
        [filter_second]
        	id=Pronk
        [/filter_second]
        with_bars=no
        [facing]
			[filter]
				id=Bigbash
    		[/filter]
       	[/facing]
        hits=yes
        [/animate]
[/animate_unit]

	[message]
		speaker=Eeep
		message= _ "No, Bigbash! Roll to the side so your wolf is not directly hit! Remember if your wolf dies, you are next!"
	[/message]
	[message]
		speaker=Zslap
		message= _ "Ancestor's bones! Those servants are riding wolves!"
	[/message]

# Zslap & Krex approach Eeep.
{MOVE_UNIT (id=Zslap) 19 22}
{MOVE_UNIT (id=Krex) 19 21}

        [scroll_to_unit]
        	id=Eeep
        [/scroll_to_unit]

	[message]
		speaker=Zslap
		message= _ "Feed us!"
	[/message]

	{MODIFY_UNIT (id=Eeep) facing sw}

	[message]
		speaker=Eeep
		message= _ "What the ?"
	[/message]
	[message]
		speaker=Zslap
		message= _ "We have traveled many miless! We are very hungry! So don't be dim. Put on your aprons and serve us a meal!"
	[/message]
	[message]
		speaker=Krex
		message= _ "He must be one of the dim ones."
	[/message]
	[message]
		speaker=Zslap
		message= _ "Are there any other kind?"
	[/message]
	[message]
		speaker=Eeep
		message= _ "We have just enough to feed ourselves. Go back where you came from."
	[/message]
	[message]
		speaker=Krex
		message= _ "See what happens when they are not disciplined? They get wild and forget the natural order of things."
	[/message]
	[message]
		speaker=Zslap
		message= _ "Let's kill them."
	[/message]

    [scroll_to_unit]
    	id=Duldursil
    [/scroll_to_unit]

	[message]
		speaker=Duldursil
		message= _ "Saurians! Dozens of them!"
	[/message]
	[message]
		speaker=Augalol
		message= _ "Guns up!"
	[/message]

# Misris moves to her keep
{MOVE_UNIT (id=Misris) 23 5}

# Zslap & Krex move to their keep
{MOVE_UNIT (id=Zslap) 4 21}
{MOVE_UNIT (id=Krex) 4 19}

  {HIGHLIGHT_IMAGE 13 8 data/campaigns/Sceptre_of_Fire/images/units/dwarves/caravan.png ()}

	[message]
        speaker=narrator
        image="wesnoth-icon.png"
        message= _ "Any spearman, rouser or impaler that goes to the dwarves' wagon becomes a thundergobo! Warning: Thundergobos have no training and can easily injure or kill the wrong target!"
    [/message]

# set menu item to make Eeep a Wolf Rider
[set_menu_item]
	id=wolfrider_option
	description= _ "Change Eeep to a Wolf Rider"

	[show_if]
		[have_unit]
			x,y=$x1,$y1
			[filter_wml]
				id=Eeep
			[/filter_wml]
		[/have_unit]
	[/show_if]

	[command]
		# Remove menu item
		[set_menu_item]
			id=wolfrider_option
			[show_if]
				[not]
				[/not]
			[/show_if]
		[/set_menu_item]

		[kill]
			id=$unit.id
		[/kill]

		[unit]
			type=Wolf Rider
			x=$unit.x
			y=$unit.y
			id=$unit.id
			name=$unit.name
			experience=$unit.experience
			side=$unit.side
			hitpoints=$unit.hitpoints
		    [modifications]
	            {TRAIT_SWAMPSAVVY}
	            {TRAIT_DIM}
				{TRAIT_LOYAL}
	        [/modifications]
	        unrenamable=yes
	        canrecruit=yes
			recruit=Goblin Spearman, Wolf Rider
		[/unit]

						[redraw]
						[/redraw]

		[sound]
			name=wolf-die.wav
		[/sound]

		{VARIABLE Eeep_is_wr yes}

	[/command]
[/set_menu_item]

        [objectives]
            side=1
            [objective]
                description= _ "Defeat Zslap"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Eeep"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Misris"
                condition=lose
            [/objective]
            [objective]
                description= _ "Turns run out"
                condition=lose
            [/objective]
            note={EARLY_FINISH_BONUS_NOTE}+{NEW_GOLD_CARRYOVER_NOTE_40}
        [/objectives]

        [objectives]
            side=3
            silent=yes
			# the rest of this tag is filled out to avoid the "No Objectives Available" message
            [objective]
                description= _ "Kill the blochin' saurians ere they kill ye!"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Eeep"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Misris"
                condition=lose
            [/objective]
            [objective]
                description= _ "Turns run out"
                condition=lose
            [/objective]
            note={EARLY_FINISH_BONUS_NOTE}+{NEW_GOLD_CARRYOVER_NOTE_40}
        [/objectives]

        [objectives]
            side=4
            silent=yes
			# the rest of this tag is filled out to avoid the "No Objectives Available" message
            [objective]
                description= _ "Defeat Zslap"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Eeep"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Misris"
                condition=lose
            [/objective]
            [objective]
                description= _ "Turns run out"
                condition=lose
            [/objective]
            note={EARLY_FINISH_BONUS_NOTE}+{NEW_GOLD_CARRYOVER_NOTE_40}
        [/objectives]

{SCATTER_UNITS 10 "Wolf, Vampire Bat, Giant Rat" 5 (
    x=1-26
    y=1-25

# sadly, units don't fade in with this macro. This gets ignored:
	show=yes

    [not]
        [filter]
        [/filter]
    [/not]

    [not]
        [filter_adjacent_location]
            [filter]
            [/filter]
        [/filter_adjacent_location]
    [/not]
) (
    side=5
)}

{INCIDENTAL_MUSIC a3deap_HighInTheMountains.ogg}
{APPEND_MUSIC weight_of_revenge.ogg}
{APPEND_MUSIC a3deap_HighInTheMountains.ogg}

[/event]

# if a spearman, rouser or impaler enters the wagon hex he becomes a Thundergobo
[event]
	name=moveto
	first_time_only=no
	[filter]
		x=13
		y=8
	[/filter]

	# check to see if unit is already a Thundergobo
	[if]
		[variable]
			name=unit.type
			equals=Thundergobo
		[/variable]

		[then]
			[message]
				speaker=narrator
				message= _ "Hey! $unit.name already has a thunderstick!"
				image=wesnoth-icon.png
			[/message]

			[allow_undo]
			[/allow_undo]
		[/then]

		[else]

	# check to see if unit is a dwarf. If so, he is either a Thunderguard, Thunderer or Dragonguard
	[if]
		[variable]
			name=unit.race
			equals=dwarf
		[/variable]

		[then]
			[message]
				speaker=narrator
				message= _ "Hey! $unit.name already has a thunderstick!"
				image=wesnoth-icon.png
			[/message]

			[allow_undo]
			[/allow_undo]
		[/then]

		[else]

	[if]
		[variable]
			name=unit.race
			not_equals=goblin
		[/variable]

		[then]  # (The unit is NOT a goblin.)
				# NOTE: Wesnoth considers Wolf Riders to be Wolves!
			[message]
				speaker=narrator
				message= _ "This unit cannot pick up a thunderstick!"
				image=wesnoth-icon.png
			[/message]

			[allow_undo]
			[/allow_undo]
		[/then]

		[else]  # (The unit IS a goblin.)
			[if]
				[variable]
					name=unit.type
					equals=Goblin Spearman
				[/variable]
				[then]
					[set_variable]
						name=xform
						value=yes
					[/set_variable]
				[/then]

				[else]  # (We know it's a goblin, but not a spearman. It must be an Impaler or Rouser.)
					[message]
						speaker=narrator
						message= _ "Are you sure you want this unit to become a Thundergobo? This choice is permanent."
						[option]
							message= _ "Yes!"
							[command]
								[set_variable]
									name=xform
									value=yes
								[/set_variable]
							[/command]
						[/option]
						[option]
							message= _ "No!"
							[command]
								[set_variable]
									name=xform
									value=no
								[/set_variable]
							[/command]
						[/option]
					[/message]
				[/else]
			[/if]

				{IF_VAR xform equals yes (
					[then]

	[store_unit]
		[filter]
			x,y=13,8
		[/filter]
		variable=unit
		kill=yes
	[/store_unit]

	# preserve the gobo's existing trait:
       [set_variables]
            name=existing_traits.trait
            to_variable=unit.modifications.trait
        [/set_variables]

	# insert traits into new unit:
        [set_variables]
            name=unit.modifications.trait

            [insert_tag]
                name=value
                variable=existing_traits.trait
            [/insert_tag]

        [/set_variables]

		# give movement points:
		{VARIABLE unit.moves 5}

        [unstore_unit]
            variable=unit
            find_vacant=no
            advance=no
        [/unstore_unit]

		{ADVANCE_UNIT (id=$unit.id) Thundergobo}

        {CLEAR_VARIABLE existing_traits,new_traits,xform}

						[redraw]
						[/redraw]

						[sound]
							name=goblin-hit-3.ogg
						[/sound]

						# unit fires the thunderstick.
						[animate_unit]
							[filter]
								id=$unit.id
							[/filter]
					        flag=attack
					        with_bars=no
							[primary_attack]
    					       name=thunderstick
					        [/primary_attack]
					        hits=yes
						[/animate_unit]

					[/then]
				)}
		[/else]
	[/if]
		[/else]
	[/if]
		[/else]
	[/if]

[/event]

[event]
	name=recruit
	[filter]
		type=Wolf Rider
	[/filter]

	{IF_VAR Eeep_is_wr equals yes (
		[else]
			[message]
				speaker=unit
				message= _ "Eeep, it is surprising to see you are not riding one of your wolves!"
			[/message]
			[message]
				speaker=Eeep
				message= _ "I know! Maybe I should fight on wolf-back."
			[/message]
			[message]
		        speaker=narrator
		        image="wesnoth-icon.png"
		        message= _ "Use the menu item on Eeep if you want to change him into a Wolf Rider! (Note: this change is permanent.)"
		    [/message]
		[/else]
	)}

[/event]


[event]
    name=die
    [filter]
		id=Zslap
    [/filter]

	[message]
		speaker=Zslap
		message= _ "Saurians retreat!"
	[/message]
    [message]
        speaker=Misris
        message= _ "Finally, they're leaving! But why are there so many of them? Why do they keep coming?"
    [/message]
    [message]
        speaker=Eeep
        message= _ "I no think they planned it this way. Who are those little guys?"
    [/message]

	# Duldursil speaks, if still alive:
    [if]
        [have_unit]
            id=Duldursil
        [/have_unit]
        [then]
		    [message]
		        speaker=Duldursil
		        message= _ "Duldursil of Dunkildorashir, at your service."
		    [/message]
		    [message]
		        speaker=Eeep
		        message= _ "You save many lives! I wish Clammie was here. He should be back by now."
		    [/message]

			# put side 3 on recall list
			{MODIFY_UNIT (side=3) side 1}
        [/then]

		# if Duldursil is gone, check for Augalol
		[else]
		    [if]
		        [have_unit]
		            id=Augalol
		        [/have_unit]
		        [then]
				    [message]
				        speaker=Augalol
				        message= _ "Augalol of Dunkildorashir, at your service."
				    [/message]
				    [message]
				        speaker=Eeep
				        message= _ "You save many lives! I wish Clammie was here. He should be back by now."
				    [/message]

					# put side 3 on recall list
					{MODIFY_UNIT (side=3) side 1}
		        [/then]

		# if both dwarves are gone, Misris speaks:
				[else]
				    [message]
				        speaker=Misris
				        message= _ "Two very noble dwarves. Their weapons were like nothing I've ever seen."
				    [/message]
				    [message]
				        speaker=Eeep
				        message= _ "They saved many lives! I wish Clammie was here. He should be back by now."
				    [/message]
				[/else]
			[/if]
		[/else]
    [/if]

# put side 4 on recall list
{MODIFY_UNIT (side=4) side 1}

    [endlevel]
        result=victory
        bonus=yes
        {NEW_GOLD_CARRYOVER 40}
    [/endlevel]

[/event]

# Eeep hits back
 [event]
        name=defender hits
        [filter_second]
            id=Eeep
        [/filter_second]
	# avoid talking animals:
    	[filter]
        	race=lizard
    	[/filter]
        [message]
            speaker=unit
            message= _ "A fierce slave indeed!"
        [/message]
        [message]
            speaker=Eeep
            message= _ "We not slaves! We work for all we have, and we'll fight to keep it!"
        [/message]
[/event]

[event]
    name=attacker hits
    [filter]
        id=Duldursil
    [/filter]
	# avoid talking to animals:
    	[filter_second]
        	race=lizard
    	[/filter_second]
    [message]
        speaker=Duldursil
        message= _ "Take that, ye briny skink!"
    [/message]
[/event]

# first Thundergobo hit
[event]
    name=attacker hits
    [filter]
        type=Thundergobo
    [/filter]

    {IF_VAR weapon.name equals thunderstick (

		[then]
		    [message]
		        speaker=unit
		        message= _ "Did you see <i>that</i>?"
		    [/message]
		[/then]
    )}
[/event]

# Bigbash make a kill:
 [event]
        name=last breath
	# avoid talking to animals:
    	[filter]
        	race=lizard
    	[/filter]
        [filter_second]
            id=Bigbash
        [/filter_second]
        [message]
            speaker=Bigbash
            message= _ "Lunatics! Why do they come here with their elderly and children?"
        [/message]
[/event]

# Augalol misses:
 [event]
        name=attacker misses
        [filter]
            id=Augalol
        [/filter]
        [message]
            speaker=Augalol
            message= _ "Blochin' flint!"
        [/message]
[/event]

# first saurian kill:
    [event]
        name=last breath
        [filter]
            type=Goblin Spearman,Wolf Rider,Thundergobo
        [/filter]
        [filter_second]
        	race=lizard
        [/filter_second]
        [message]
            speaker=second_unit
            message= _ "Now do you realize we are your betters?"
        [/message]
    [/event]

# on death of Eeep
    [event]
        name=die
        [filter]
            id=Eeep
        [/filter]

        [message]
            speaker=Eeep
            message= _ "I wish Clammie were here!"
        [/message]

        [endlevel]
            result=defeat
        [/endlevel]
    [/event]

# on death of Misris
    [event]
        name=die
        [filter]
            id=Misris
        [/filter]

        [message]
            speaker=Misris
            message= _ "Eeep, my love! Please find the courage to continue without me."
        [/message]
        [message]
            speaker=Eeep
            message= _ "What you ask is impossible, dear Misris."
        [/message]
        [endlevel]
            result=defeat
        [/endlevel]
    [/event]

# on death of Duldursil
    [event]
        name=die
        [filter]
            id=Duldursil
        [/filter]

        [message]
            speaker=Duldursil
            message= _ "Blochin' afterlife!"
        [/message]

    [/event]

# Augalol's death
    [event]
        name=die
        [filter]
            id=Augalol
        [/filter]
        [message]
            speaker=Augalol
            message= _ "I think my hammer jammed!"
        [/message]
    [/event]

# out of time:
  [event]
        name=time over
        [message]
            speaker=Misris
            message= _ "There are too many of them! We are defeated!"
        [/message]
        [endlevel]
            result=defeat
        [/endlevel]
    [/event]

[/scenario]
